# JSON → Google Slides 変換 GASアプリ

JSONデータから高品質なGoogleスライドを自動生成するGoogle Apps Scriptアプリケーションです。
React(Vite)製の洗練されたフロントエンドUIを備え、スライドの内容だけでなくデザイン設定（カラー、フォント、フッター等）も直感的に操作してスライドを生成できます。

## 特徴

- **直感的な2カラムUI**:
  - **左カラム**: JSONエディタ。スライドの構成・内容を直接編集可能。
  - **右カラム**: デザイン設定パネル。配色、フォント、フッター、保存先などをリアルタイムに変更可能。
- **高品質な60種類以上のスライドレイアウト**: 定番のタイトルやアジェンダから、タイムライン、KPI指標、統計比較、フローチャートなど、あらゆるビジネスニーズに対応する豊富なプリセットを網羅。
- **拡張された生成エンジン**: Generator Map方式による拡張性の高い設計。新規レイアウトの追加が容易です。
- **柔軟なカスタマイズ**: `FastAPI` + `Pydantic` 風のスキーマ設計（GAS上のTypeScript）により、型安全でメンテナンス性が高い構成。
- **自動プレビュー**: スライド生成完了後、自動的に新規タブでGoogleスライドが開きます。
- **モダンな開発スタック**: TypeScript + Webpack + clasp + React 19 + Vite + Tailwind CSS v4。

## 実装されている主なスライドタイプ

| カテゴリ | type | 内容 |
| :--- | :--- | :--- |
| **基本** | `title` | タイトルスライド（日付、装飾付き） |
| | `agenda` | プログラム・目次（番号バッジ付き） |
| | `section` | セクション区切り（大きな番号と背景色） |
| | `closing` | 締めスライド（Thank Youメッセージ） |
| **コンテンツ** | `content` | 汎用コンテンツ（箇条書き、2カラム構成対応） |
| | `imageText` | 画像＋テキスト（配置入れ替え対応） |
| | `quote` | 引用・代表メッセージ |
| **比較・リスト** | `compare` | 左右比較（赤vs青のカラム表示） |
| | `cards` | 柔軟なカード形式（2-3列グリッド表示） |
| | `headerCards` | ヘッダー付きカード（グリッド表示） |
| | `bulletCards` | カード型箇条書き（バッジ付き） |
| **図解・工程** | `process` | ステップ手順（矢印ナビゲーション付き） |
| | `processList` | リスト形式の工程図 |
| | `timeline` | タイムライン図（マイルストーン別状態表示対応） |
| | `diagram` | スイムレーン図（横並びのフロー構造） |
| | `cycle` | サイクル図（循環構造） |
| | `triangle` | 三角形ダイアグラム（相関関係） |
| | `pyramid` | ピラミッド図（階層構造） |
| | `flowChart` | フローチャート（複数の工程フロー） |
| | `stepUp` | 階段式ステップ（昇段形式） |
| **データ・表** | `table` | 標準テーブル（ヘッダー行対応） |
| | `progress` | 進捗バー（達成率表示） |
| | `kpi` | KPI指標（数値、変化率、ステータス表示） |
| | `statsCompare` | 統計数値比較 |
| | `barCompare` | 棒グラフによる数値比較 |
| | `faq` | よくあるご質問（Q&A形式） |

※その他、`parallelHorizontal`, `matrixPos`, `vennDiagram` など、合計60種類以上の特殊・拡張レイアウト（後方互換）に対応しています。

## 制限事項・既知の課題

- **画像プレースホルダーの事前確保について**:
  Google Slides API（GAS環境）の仕様上、画像を後から挿入するための「空の画像プレースホルダー（枠）」をスライド上に予め確保・配置しておく処理は、本アプリケーションの実装として技術的に困難です。スライドに画像を組み込む場合は、生成後のスライドに対して手動で画像を挿入・サイズ調整していただくことを推奨しています。

## 開発環境

### バックエンド (GAS)

- **TypeScript**: 型安全性とモダンな機能を利用。
- **Webpack**: モジュールを `code.js` にバンドル。
- **Clasp**: CLIによるデプロイ管理。

### フロントエンド (UI)

- **React 19 + TypeScript + Vite**: 高速な開発とモダンな構成。
- **Tailwind CSS v4**: 最新のユーティリティファーストCSSフレームワーク。

## テスト

品質維持のため、ユニットテストおよびE2Eテストを導入しています。

### ユニットテスト (Jest)

主にユーティリティ関数やロジックの検証を行います。

```bash
npm test
```

### E2Eテスト (Playwright)

フロントエンドUIの動作検証を実ブラウザで行います。

```bash
cd frontend
npm run e2e
```

- `npm run e2e:ui`: インタラクティブなUIモードでテストを実行
- `npm run e2e:headed`: ブラウザ画面を表示してテストを実行

## 使い方

### 1. セットアップ

1. リポジトリのルートで `npm install`
2. `frontend` ディレクトリでも `npm install`
3. `.clasp.json.example` を `.clasp.json` にコピーし、`scriptId` を設定。
4. `npx clasp login` で認証。

### 2. ローカル開発

フロントエンドの編集・確認：

```bash
cd frontend
npm run dev
```

`http://localhost:3000` でUIを確認できます。

### 3. デプロイ

```bash
npm run build
npm run push
```

## 謝辞（クレジット）

本プロジェクトは、**まじん**氏による note 記事[「【究極】まじん式プロンプトv3」](https://note.com/majin_108/n/n11fc2f2190e9)で紹介されているコンセプトおよびスライド生成ロジックを参考に実装・拡張したものです。

- **参照元**: [【究極】まじん式プロンプトv3｜まじん](https://note.com/majin_108/n/n11fc2f2190e9)

## コマンド一覧（ルート）

| コマンド | 内容 |
| --- | --- |
| `npm run build` | フロントエンド・バックエンドのビルドと成果物の集約 |
| `npm run push` | GASへのデプロイ (`clasp push`) |
| `npm run watch` | 変更を監視して自動ビルド |
| `npm test` | Jestによるユニットテスト実行 |
| `npm run open` | GASエディタを開く |
